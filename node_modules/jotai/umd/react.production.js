!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("jotai/vanilla"),require("jotai/vanilla/internals")):"function"==typeof define&&define.amd?define(["exports","react","jotai/vanilla","jotai/vanilla/internals"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).jotaiReact={},e.React,e.jotaiVanilla,e.jotaiVanillaInternals)}(this,function(e,t,n,r){"use strict";var u=t.createContext(void 0);function i(e){var r=t.useContext(u);return(null==e?void 0:e.store)||r||n.getDefaultStore()}var o=function(e){return"function"==typeof(null==e?void 0:e.then)},a=function(e){e.status||(e.status="pending",e.then(function(t){e.status="fulfilled",e.value=t},function(t){e.status="rejected",e.reason=t}))},c=t.use||function(e){if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;throw"rejected"===e.status?e.reason:(a(e),e)},f=new WeakMap,l=function(e,t,n){var u=r.INTERNAL_getBuildingBlocksRev2(e)[26],i=f.get(t);return i||(i=new Promise(function(r,a){var c=t,l=function(e){return function(t){c===e&&r(t)}},s=function(e){return function(t){c===e&&a(t)}},v=function(){try{var t=n();o(t)?(f.set(t,i),c=t,t.then(l(t),s(t)),u(e,t,v)):r(t)}catch(e){a(e)}};t.then(l(t),s(t)),u(e,t,v)}),f.set(t,i)),i};function s(e,n){var r=n||{},u=r.delay,f=r.unstable_promiseStatus,s=void 0===f?!t.use:f,v=i(n),d=t.useReducer(function(t){var n=v.get(e);return Object.is(t[0],n)&&t[1]===v&&t[2]===e?t:[n,v,e]},void 0,function(){return[v.get(e),v,e]}),g=d[0],p=g[0],h=g[1],j=g[2],m=d[1],y=p;if(h===v&&j===e||(m(),y=v.get(e)),t.useEffect(function(){var t=v.sub(e,function(){if(s)try{var t=v.get(e);o(t)&&a(l(v,t,function(){return v.get(e)}))}catch(e){}"number"!=typeof u?m():setTimeout(m,u)});return m(),t},[v,e,u,s]),t.useDebugValue(y),o(y)){var b=l(v,y,function(){return v.get(e)});return s&&a(b),c(b)}return y}function v(e,n){var r=i(n),u=t.useCallback(function(){for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return r.set.apply(r,[e].concat(n))},[r,e]);return u}e.Provider=function(e){var r=e.children,i=e.store,o=t.useRef(null);return i?t.createElement(u.Provider,{value:i},r):(null===o.current&&(o.current=n.createStore()),t.createElement(u.Provider,{value:o.current},r))},e.useAtom=function(e,t){return[s(e,t),v(e,t)]},e.useAtomValue=s,e.useSetAtom=v,e.useStore=i});
